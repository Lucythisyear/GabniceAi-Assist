<header>
  <nav>
    <div class="logo">GabniceAi Assist</div>
  </nav>
</header>

<main>
  <!-- Chat Section -->
  <section id="chat">
    <h2>Talk to GabniceAi Assist</h2>
    <div class="chatbox">
      <div id="messages"></div>
      <input type="text" id="user-input" placeholder="Type a message and press Enter">
    </div>
  </section>
</main>

<script>
const messagesDiv = document.getElementById("messages");
const input = document.getElementById("user-input");

input.addEventListener("keypress", async (e) => {
  if (e.key === "Enter") {
    const message = input.value.trim();
    if (!message) return;

    messagesDiv.innerHTML += `<div class="user-msg">${message}</div>`;
    input.value = "";

    // Show "thinking..."
    messagesDiv.innerHTML += `<div class="ai-msg">Thinking...</div>`;

    try {
      const res = await fetch("/.netlify/functions/ai", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: message })
      });

      const data = await res.json();
      messagesDiv.innerHTML += `<div class="ai-msg">${data.reply}</div>`;
    } catch (err) {
      messagesDiv.innerHTML += `<div class="ai-msg error">Error: ${err.message}</div>`;
    }
  }
});
</script>
